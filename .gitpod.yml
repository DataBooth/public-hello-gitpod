#image: condaforge/miniforge3:latest
#  file: Dockerfile

# List the start up tasks. Learn more https://www.gitpod.io/docs/config-start-tasks/
tasks:
  - name: Dependencies - conda (via Mambaforge / Miniforge)
  - init: |
      echo 'init script' # runs during prebuild
      curl -L https://github.com/conda-forge/miniforge/releases/latest/download/Mambaforge-Linux-x86_64.sh \
        --output /workspace/Mambaforge3-Linux-x86_64.sh
      bash /workspace/Mambaforge3-Linux-x86_64.sh -b -p /workspace/miniforge3
      echo "PATH="/workspace/miniforge3/bin:$PATH"" >> ${HOME}/.bashrc
      source ~/.bashrc
      rm /workspace/Mambaforge3-Linux-x86_64.sh
      mamba install -c conda-forge jupyterlab -y
    command: conda -V && python -V

## NOTE: /home/gitpod/mambaforge is where things are being install - for some reason
#.       .bashrc is not getting updated with conda info

# List the ports to expose. Learn more https://www.gitpod.io/docs/config-ports/
ports:
  - port: 8888
    onOpen: open-browser

